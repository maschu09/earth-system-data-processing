This notebook briefly demonstrates how to download era5 climate dataas a netcdf file, regrid its data from a common longitude-latitude grid to a healpix grid, saves it as zarr data type and compares the original data to the regridded data.


ERA5 is the fifth generation ECMWF reanalysis for the global climate and weather for the past 8 decades(https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=overview). While there are a wide variety of meteorological variables available this notebook will focus on the specific humidity for a few days in early december of 2024. While it is possible to generalize the notebook for more variables, time constraint only allowed me to implement the specific humidity directly. Other variables would sadly break the notebook as it is right now.
To gain access to the data it is necessary to create an account at https://cds.climate.copernicus.eu/how-to-api. It is important to also create a local token file and to accept the terms of use on the website. The process of creating a token and how to quickliy downloading some data is demonstrated on the website.
The downloading process is implemented in way that allows for quick processing of daily data, skipping allready existing files in the download process.

The orignial data is downloaded as netcdf and then locally regridded onto a healpix grid(https://healpix.sourceforge.io/). The physics behind the transformation is quite complicated, but the main draw of healpix is, that it represents all pixel areas in the same size. The regridding algorithm works by tranforming the geographical coordinates into "pixels" with a resolution given by the parameter ndim. In the second step the the original values of the variable need to be remapped to their coresponding pixels creating a one-dimensional array that can visualized on a global map. The pixel coordinates and and the corresponding variable values are then stored as zarr type data.
This part was quite challenging for me and took several days of work to implement, as there only very few examples online of people trying to remap netcdf data or similiar file format data to healpix.

The process of saving from netcd or xarray datasets to zarr is only demontrated briefly as my main focus was on healpix. The main idea is to append the new data to the allready existing zarr files, while chunking mainly the large pixel dimension and
keeping the other dimensions as is. Unfortunaley the zarr chunking is only implemented by overwriting the old data instead of appending, because of the wrong use of "mode-parameters" while saving from xarray to zarr.
